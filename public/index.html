<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Elementa</title>

  <!-- Global + Component CSS -->
  <style>
    /* RESET */
    * { margin:0; padding:0; box-sizing:border-box; }
    html,body { height:100%; font-family:Inter,system-ui,sans-serif; background:#0f0f0f; color:#fff; }

    /* SHELL */
    #main-ecosystem { display:flex; flex-direction:column; height:100%; opacity:0; transition:opacity .6s ease; }
    #top-bar { height:56px; display:flex; align-items:center; padding:0 16px; backdrop-filter:blur(20px); background:rgba(255,255,255,.05); border-bottom:1px solid rgba(255,255,255,.08); }
    .app-title { font-size:20px; font-weight:600; }
    #view-container { flex:1; overflow-y:auto; padding:16px; }
    #bottom-nav { height:60px; display:flex; justify-content:space-around; align-items:center; backdrop-filter:blur(20px); background:rgba(255,255,255,.05); border-top:1px solid rgba(255,255,255,.08); }
    #bottom-nav button { background:none; border:none; color:#fff; font-size:14px; cursor:pointer; }

    /* SPLASH */
    #splash-screen { position:fixed; inset:0; background:#000; display:flex; justify-content:center; align-items:center; z-index:999; transition:opacity .8s ease; }
    #splash-screen.reveal-ecosystem { opacity:0; pointer-events:none; }
    .splash-logo { font-size:32px; font-weight:700; letter-spacing:2px; }

    /* COMPONENTS */
    .post-card { background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); border-radius:14px; padding:16px; margin-bottom:16px; backdrop-filter:blur(20px); }
    .message-bubble { max-width:70%; padding:10px 14px; border-radius:14px; margin-bottom:10px; }
    .message-bubble.sent { background:rgba(255,255,255,.12); align-self:flex-end; }
    .message-bubble.received { background:rgba(255,255,255,.06); align-self:flex-start; }
    .profile-card { background:rgba(255,255,255,.08); border:2px solid rgba(255,255,255,.2); border-radius:18px; padding:20px; text-align:center; }
  </style>
</head>
<body>

  <!-- Splash -->
  <div id="splash-screen"><div class="splash-logo">Elementa</div></div>

  <!-- Shell -->
  <div id="main-ecosystem">
    <header id="top-bar"><h1 class="app-title">Elementa</h1></header>
    <main id="view-container"></main>
    <nav id="bottom-nav">
      <button data-view="feed">Feed</button>
      <button data-view="messages">Messages</button>
      <button data-view="profile">Profile</button>
      <button data-view="discovery">Discover</button>
      <button data-view="support">Support</button>
    </nav>
  </div>

  <!-- Scripts -->
  <script type="module">
    // prompts.js
    export const prompts = {
      feed: {
        professional: (topic) => `Draft a concise professional update about ${topic}.`,
        casual: (topic) => `Write a casual post about ${topic}.`,
        academic: (topic) => `Summarize ${topic} with academic tone.`
      },
      messages: {
        friendly: (msg) => `Generate a warm reply to: "${msg}".`,
        professional: (msg) => `Respond professionally to: "${msg}".`,
        humorous: (msg) => `Craft a witty reply to: "${msg}".`
      }
    };
  </script>

  <script type="module">
    // ai.js
    export async function getGeminiResponse(prompt) {
      try {
        const res = await fetch("/api/gemini", {
          method:"POST", headers:{ "Content-Type":"application/json" },
          body: JSON.stringify({ prompt })
        });
        const data = await res.json();
        return data.output || "AI unavailable.";
      } catch { return "AI error."; }
    }
  </script>

  <script type="module">
    // navigation.js
    const viewContainer = document.getElementById("view-container");
    const cache = new Map();

    async function loadView(view) {
      if (cache.has(view)) { viewContainer.innerHTML = cache.get(view); return; }
      let html = "";
      switch(view) {
        case "feed": html = `<section><h2>Feed</h2><textarea id="post-input"></textarea><button id="ai-draft-btn">AI Draft</button><button id="share-btn">Post</button><div id="social-feed"></div></section>`; break;
        case "messages": html = `<section><h2>Messages</h2><div id="messages-list"></div><div id="message-composer"><input id="message-input"/><button id="send-message-btn">Send</button></div></section>`; break;
        case "profile": html = `<section><h2>Profile</h2><div class="profile-card"><h2>User</h2><p>Status: Active</p></div></section>`; break;
        case "discovery": html = `<section><h2>Discover</h2><p>Discovery engine coming soon...</p></section>`; break;
        case "support": html = `<section><h2>Support</h2><button>Report Issue</button><button>Contact Support</button></section>`; break;
      }
      cache.set(view, html);
      viewContainer.innerHTML = html;
    }

    function bindNav() {
      document.querySelectorAll("[data-view]").forEach(btn=>{
        btn.addEventListener("click",()=>loadView(btn.dataset.view));
      });
    }

    export function initRouter() { bindNav(); loadView("feed"); }
  </script>

  <script type="module">
    // splash.js
    export function runSplash() {
      const splash = document.getElementById("splash-screen");
      const app = document.getElementById("main-ecosystem");
      setTimeout(()=>{ splash.classList.add("reveal-ecosystem"); app.style.opacity="1"; },1500);
    }
  </script>

  <script type="module">
    // master.js
    import { initRouter } from "./navigation.js";
    import { runSplash } from "./splash.js";
    import { getGeminiResponse } from "./ai.js";
    import { prompts } from "./prompts.js";

    window.addEventListener("load", async ()=>{
      runSplash();
      initRouter();
      const preview = await getGeminiResponse(prompts.feed.professional("Elementa launch"));
      console.log("AI preview:", preview);
    });
  </script>

</body>
    </html>
    
